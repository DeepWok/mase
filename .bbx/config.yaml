
# Define a runner that will be used to run a job
runners:
  ubuntu-runner:
    image: deepwok/mase-docker-cuda:latest


# Define a workflow to orchestrate a job
workflows:
  mase-chop-regression:
    triggers:
      - manual
    jobs:
      - chop-regression

  mase-hw-regression:
    triggers:
      - manual
    jobs:
      - hw-regression


# Define a job to be performed during a workflow
jobs:
  choose-commit:
    runner: ubuntu-runner
    steps:
      - run:
          name: Define diff commit
          command: | 
            DIFF_COMMIT_NAME="HEAD^"

  chop-regression:
    runner: ubuntu-runner
    resource_spec: large
    steps:
      - run:
          name: Run software regression
          command: |
            bash scripts/test-machop.sh

  hw-regression:
    runner: ubuntu-runner
    steps:
      - run:
          name: Run hardware regression
          command: |
            python3 scripts/test-hardware.py -a

